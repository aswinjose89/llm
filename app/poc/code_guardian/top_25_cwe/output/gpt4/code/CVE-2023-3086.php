
// Save user settings
$('#profile-user-save-settings').click(function () {
 var data = {
  'name': DOMPurify.sanitize($('#profile-user-name').val()),
  'lastname': DOMPurify.sanitize($('#profile-user-lastname').val()),
  'email': DOMPurify.sanitize($('#profile-user-email').val()),
  'timezone': $('#profile-user-timezone').val(),
  'language': $('#profile-user-language').val().toLowerCase(),
  'treeloadstrategy': $('#profile-user-treeloadstrategy').val().toLowerCase(),
  'agsescardid': $('#profile-user-agsescardid').length > 0 ? $('#profile-user-agsescardid').val() : ''
 };
 $.post(
 "sources/users.queries.php",
 {
 type: 'user_profile_update',
 data: JSON.stringify(data),
 isprofileupdate: true
 },
 function (response) {
 if (response.error === true) {
 toastr.remove();
 toastr.error(response.message, '', { closeButton: true });
 } else {
 toastr.remove();
 toastr.success('Settings updated successfully.', '', { closeButton: true });
 }
 }
 ).fail(function (jqXHR, textStatus) {
 toastr.remove();
 toastr.error('Request failed: ' + textStatus, '', { closeButton: true });
 });
});

