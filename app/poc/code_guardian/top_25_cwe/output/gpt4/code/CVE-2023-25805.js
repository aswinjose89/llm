'use strict';

const child = require('child_process');

function GitFn(version, options) {
  this._version = version;
  this._options = {
    cwd: options.dir,
    env: process.env,
    setsid: false,
    stdio: [0, 1, 2]
  };
}
module.exports = GitFn;

GitFn.prototype = {
  tag: function(cb) {
    var cmd = ['git', 'tag', `v${this._version}`];
    this._execSafe(cmd, cb);
  },
  untag: function(cb) {
    var cmd = ['git', 'tag', '-d', `v${this._version}`];
    this._execSafe(cmd, cb);
  },
  commit: function(cb) {
    var cmd = ['git', 'commit', '-am', `${this._version}`];
    this._execSafe(cmd, cb);
  },
  _execSafe: function(cmd, cb) {
    child.execFile('git', cmd, this._options, cb);
  }
};
