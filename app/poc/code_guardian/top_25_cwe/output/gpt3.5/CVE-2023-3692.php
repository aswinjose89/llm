{
  "programming_language": "PHP",
  "compiler_name": "N/A",
  "fixed_source_code": "<?php\ntry {\n    $imagesPath = ADMIDIO_PATH . FOLDER_DATA . '/' . $folderName . '/images';\n\n    FileSystemUtils::createDirectoryIfNotExists($imagesPath);\n\n    // create a filename with a timestamp and a 16 chars secure-random string,\n    // so we have a scheme for the filenames and the risk of duplicates is negligible.\n    // Format: 20180131-123456_0123456789abcdef.jpg\n    $filename = FileSystemUtils::getGeneratedFilename($_FILES['upload']['name']);\n\n    $htmlUrl = SecurityUtils::encodeUrl(ADMIDIO_URL . '/adm_program/system/show_image.php', array('module' => $folderName, 'file' => $filename));\n\n    move_uploaded_file($_FILES['upload']['tmp_name'], $imagesPath . '/' . $filename);\n} catch (RuntimeException $exception) {\n    $message = $exception->getMessage();\n}\n\n// now call CKEditor function and send photo data\necho '<!DOCTYPE html>\n<html>\n    <body>\n        <script type=\"text/javascript\">\n            window.parent.CKEDITOR.tools.callFunction('.$getCKEditorFuncNum.', \"'.htmlspecialchars($htmlUrl).'\", \"'.htmlspecialchars($message).'\");\n        <\\/script>\n    </body>\n<\\/html>';",
  "executive_summary": "The source code contains vulnerabilities that could potentially lead to security breaches and data loss.",
  "vulnerability_details": [
    {
      "vulnerability_type": "File Upload Vulnerability",
      "cwe": "CWE-434",
      "cvss_score": "N/A",
      "nvd": "N/A"
    }
  ]
}