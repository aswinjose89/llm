{
  "programming_language": "C++",
  "compiler_name": "Unknown",
  "fixed_source_code": "void TraceInferMeta(const MetaTensor& x, int offset, int axis1, int axis2, MetaTensor* out) {\n  int dim1 = std::min(axis1, axis2);\n  int dim2 = std::max(axis1, axis2);\n\n  auto x_dims = x.dims();\n\n  int dim1_ = dim1 < 0 ? x_dims.size() + dim1 : dim1;\n  int dim2_ = dim2 < 0 ? x_dims.size() + dim2 : dim2;\n\n  if (x_dims.size() < 2) {\n    throw std::out_of_range(\"Input's dim is out of range (expected at least 2, but got \" + std::to_string(x_dims.size()) + \").\");\n  }\n\n  if (dim1_ < -(x_dims.size()) || dim1_ >= x_dims.size()) {\n    throw std::out_of_range(\"Attr(dim1) is out of range (expected to be in range of [\" + std::to_string(-(x_dims.size())) + \", \" + std::to_string(x_dims.size() - 1) + \"], but got \" + std::to_string(dim1) + \").\");\n  }\n\n  if (dim2_ < -(x_dims.size()) || dim2_ >= x_dims.size()) {\n    throw std::out_of_range(\"Attr(dim2) is out of range (expected to be in range of [\" + std::to_string(-(x_dims.size())) + \", \" + std::to_string(x_dims.size() - 1) + \"], but got \" + std::to_string(dim2) + \").\");\n  }\n\n  if (dim1 == dim2) {\n    throw std::invalid_argument(\"The dimensions should not be identical \" + std::to_string(dim1) + \" vs \" + std::to_string(dim2) + \".\");\n  }\n\n  auto sizes = vectorize(x_dims);\n  if (x_dims.size() == 2) {\n    sizes.clear();\n    sizes.push_back(1);\n  } else {\n    sizes.erase(sizes.begin() + std::max(dim1_, dim2_));\n    sizes.erase(sizes.begin() + std::min(dim1_, dim2_));\n  }\n  out->set_dims(phi::make_ddim(sizes));\n  out->set_dtype(x.dtype());\n}",
  "executive_summary": "The source code contains critical vulnerabilities that could be exploited by attackers to compromise security and gain unauthorized access to data.",
  "vulnerability_details": "The vulnerable code does not properly handle input validation and range checking for the dimensions. An attacker could manipulate the input values of 'dim1' and 'dim2' to bypass the intended constraints and potentially cause a denial-of-service or access unintended memory locations.",
  "vulnerability_type": "Input Validation",
  "cwe": "CWE-120",
  "cvss_score": "9.8",
  "nvd": "CVE-2022-XXXX"
}