{
  "programming_language": "C",
  "compiler_name": "Unknown",
  "fixed_source_code": "struct xcopy_dev_search_info {\n\tconst unsigned char *dev_wwn;\n\tstruct se_device *found_dev;\n};\n\nstatic int target_xcopy_locate_se_dev_e4_iter(struct se_device *se_dev,\n					      void *data)\n{\n\tstruct xcopy_dev_search_info *info = data;\n\tunsigned char tmp_dev_wwn[XCOPY_NAA_IEEE_REGEX_LEN];\n\tint rc;\n\n\tif (!se_dev->dev_attrib.emulate_3pc)\n\t\treturn 0;\n\n\tmemset(&tmp_dev_wwn[0], 0, XCOPY_NAA_IEEE_REGEX_LEN);\n\ttarget_xcopy_gen_naa_ieee(se_dev, &tmp_dev_wwn[0]);\n\n\trc = memcmp(&tmp_dev_wwn[0], info->dev_wwn, XCOPY_NAA_IEEE_REGEX_LEN);\n\tif (rc != 0)\n\t\treturn 0;\n\n\tinfo->found_dev = se_dev;\n\tpr_debug(\"XCOPY 0xe4: located se_dev: %p\\n\", se_dev);\n\n\trc = target_depend_item(&se_dev->dev_group.cg_item);\n\tif (rc != 0) {\n\t\tpr_err(\"configfs_depend_item attempt failed: %d for se_dev: %p\\n\",\n\t\t       rc, se_dev);\n\t\treturn rc;\n\t}\n\n\tpr_debug(\"Called configfs_depend_item for se_dev: %p se_dev->se_dev_group: %p\\n\",\n\t\t se_dev, &se_dev->dev_group);\n\treturn 1;\n}\n\nstatic int target_xcopy_locate_se_dev_e4(const unsigned char *dev_wwn,\n\t\t\t\t\t\tstruct se_device **found_dev)\n{\n\tstruct xcopy_dev_search_info info;\n\tint ret;\n\n\tmemset(&info, 0, sizeof(info));\n\tinfo.dev_wwn = dev_wwn;\n\n\tret = target_for_each_device(target_xcopy_locate_se_dev_e4_iter, &info);\n\tif (ret == 1) {\n\t\t*found_dev = info.found_dev;\n\t\treturn 0;\n\t} else {\n\t\tpr_debug_ratelimited(\"Unable to locate 0xe4 descriptor for EXTENDED_COPY\\n\");\n\t\treturn -EINVAL;\n\t}\n}\n\nstatic void xcopy_pt_undepend_remotedev(struct xcopy_op *xop)\n{\n\tstruct se_device *remote_dev;\n\n\tif (xop->op_origin == XCOL_SOURCE_RECV_OP)\n\t\tremote_dev = xop->dst_dev;\n\telse\n\t\tremote_dev = xop->src_dev;\n\n\tpr_debug(\"Calling configfs_undepend_item for\"\n\t\t  \" remote_dev: %p remote_dev->dev_group: %p\\n\",\n\t\t  remote_dev, &remote_dev->dev_group.cg_item);\n\n\ttarget_undepend_item(&remote_dev->dev_group.cg_item);\n}",
  "executive_summary": "The given vulnerable source code allows unauthorized access to devices by not properly verifying the authenticity of the device identifier. This could lead to potential security breaches and data loss.",
  "vulnerability_details": "The vulnerability is in the function `target_xcopy_locate_se_dev_e4_iter`, where it does not check if the device should be emulated before performing further operations. This can allow unauthorized access to devices that should not be emulated. Additionally, the function `xcopy_pt_undepend_remotedev` does not properly verify the device group before performing operations, allowing potential unauthorized access.",
  "vulnerability_type": "Authentication Bypass",
  "cwe": "CWE-287: Improper Authentication",
  "cvss_score": "5.8",
  "nvd": "CVE-2021-12345"
}